---
layout: post
title: Limiting The Effect of the HTML Injection Issue in tagcloud.swf
date: 2011-09-04 11:19:15.000000000 -07:00
tags:
- Security
- update
- HB-Cumulus
- WP-Cumulus
- fix
type: post
published: false
---
<p>Roy Tanck released the snazzy <a href="https://wordpress.org/extend/plugins/wp-cumulus/" target="_blank">WP-Cumulus</a> plugin, which I then ported to Habari in the form of HB-Cumulus.  I literally just took the tagcloud.swf file and then wrapped it in PHP code to make it a Habari plugin.</p>
<p>WP-Cumulus hasn't been updated in quite some time (last updated 2010-8-18).  Way back on 2009/2010 MustLive notified Roy of a XSS issue and a HTML injection issue in tagcloud.swf.</p>
<p>Roy quickly rectified the XSS issue and I followed suit with HB-Cumulus 1.5 (WARNING: Anyone using HB-Cumulus 1.4 or earlier, you are vulnerable to a XSS issue), but he didn't rectify the HTML Injection issue.</p>
<p>Now the HTML Injection issue itself isn't really much of an issue as you can't actually do very much other than get the flash cloud to display a tag with a URL to wherever you like. This can't actually be used to compromise a website or read user info or execute arbitrary code on the host or in the client browser, however I can be used to source the tagcloud.swf from someone else's site and use it to provide links to wherever you like.</p>
<p>I've modified the ActionScript (AS3 is surprisingly easy to follow and write.  The hardest part of trying to compile it again without Flash CS - I gave up and downloaded a trial version for this).</p>
<p>My change doesn't stop this "injection" as it would mean the plugin wouldn't actually do anything and wouldn't be useful, I have however changed it to limit it's use to those not actually hosting the tagcloud.swf file.</p>
<p>Essentially, I've enforced checking of all links to make sure they point to URLs on the same host as is hosting the tagcloud.swf file.  I have hoped Flash would do this itself, but I could never get it to warn me unless I was hosting it locally.</p>
<p>For those curios to backport this directly into the WP-Cumulus code, here's the diff:</p>
<p>... and I've even generated a new tagcloud.swf for you.</p>
<p>For users of HB-Cumulus, I've now released HB-Cumulus 1.x with it's own HB-Cumulus specific tagcloud.swf.  I'm using my own file now for several reasons: </p>
<p>1.  As I've modified the source, I may as well give myself the credit for fixing this issue (I've done this in the WP-Cumulus too), but at the same time I've updated the link you go to when clicking the menu.</p>
<p>2.  I was never comfortable with the flash file itself saying it was part of WP-Cumulus when it was actually part of HB-Cumulus.</p>
