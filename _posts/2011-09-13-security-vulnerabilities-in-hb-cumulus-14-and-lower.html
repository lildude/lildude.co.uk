---
layout: post
title: Security Vulnerabilities in HB-Cumulus 1.4 and Lower
date: 2011-09-13 02:52:31.000000000 -07:00
tags:
- Security
- HB-Cumulus
type: post
published: true
---
<p>This week an announcement was made on <a href="http://seclists.org/fulldisclosure/2011/Sep/101" target="_blank">Seclist.org about a XSS and HTML Injection vulnerability</a> in all the plugins that use the original <code>tagcloud.swf</code> from WP-Cumulus (which includes <a href="/projects/hb-cumulus">HB-Cumulus</a>).</p>
<p class="alertbox">The XSS vulnerability was fixed a long long time ago in HB-Cumulus - 19 December 2009 to be precise - so if you are running HB-Cumulus 1.4 or earlier, you <strong>MUST</strong> upgrade.</p>
<p>The HTML Injection issue hasn't and can't be resolved due to the way the plugin works.  That said, I'm not sure this is really much of an issue.</p>
<p>In short, the way the tagcloud.swf works is it takes input in the form of a string (as an argument) or from a xml file.  The only HTML tag that are used and accepted by the plugin is the <code>&lt;a&gt;</code> tag.  This is how the tag cloud knows that to display and link to without actually having to rebuild the Flash file repeatedly.</p>
<p>Now the HTML injection vulnerability basically states that this "feature" allows anyone to set any link they like, which is correct and true.  Now this <em>could</em> be used to insert links to malicious sites, but in order for that to happen the "hacker" would have to have control of the HTML page in which the tagcloud.swf is embedded and thus effectively using the tagcloud.swf as it was designed.</p>
<p>This can NOT be used to exploit the security of the site hosting the <code>tagcloud.swf</code> file.</p>
<p>I have whipped up a rebuild of the <code>tagcloud.swf</code> that doesn't stop this issue (I can't else the plugin wouldn't work and everyone would need to recompile the tagcloud.swf everytime they updated a post) but it does limit the effectiveness of the links and by only displaying the links if they link to a domain that is the same as that hosting the tagcloud.swf file.</p>
<p>I'll test this for a couple of days on my own sites (it's in place on this site already) and if I don't spot any problems, I'll release an updated version of HB-Cumulus with this updated file in it.</p>
